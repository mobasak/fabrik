services:
  docs:
    image: node:20-alpine
    container_name: {{ name }}-docs
    working_dir: /app
    command: ["npm", "run", "serve", "--", "--host", "0.0.0.0", "--port", "3000"]
    volumes:
      - ./site:/app
    networks:
      - coolify
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.{{ name }}.rule=Host(`{{ domain }}`)"
      - "traefik.http.routers.{{ name }}.entrypoints=https"
      - "traefik.http.routers.{{ name }}.tls=true"
      - "traefik.http.routers.{{ name }}.tls.certresolver=letsencrypt"
      - "traefik.http.services.{{ name }}.loadbalancer.server.port=3000"
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:3000"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  coolify:
    external: true
